{"version":3,"sources":["2/script.js"],"names":["isMobile","test","navigator","userAgent","console","log","width","window","innerWidth","height","innerHeight","canvas","document","querySelector","context","getContext","lineCanvas","createElement","lineContext","popCanvas","animationId","popContext","sceneInfo","x","speed","second","size","popCount","gameCount","popSpeed","nodes","i","Math","floor","push","Array","fill","colors","pop","colorNo","random","xIdx","yIdx","y","fillStyle","fillRect","remove","idx","tx","length","clearRect","tick","timestamp","s","f","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","drawImage","getElementById","style","display","cancelAnimationFrame","requestAnimationFrame","buttons","querySelectorAll","forEach","button","addEventListener"],"mappings":"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","file":"script.8b1c38b8.js","sourceRoot":"../src","sourcesContent":["import \"./style.css\";\nlet isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n  navigator.userAgent\n);\nconsole.log(isMobile ? \"mobile\" : \"not mobile\");\n\nlet width = window.innerWidth;\nlet height = window.innerHeight - 100;\n\nconst canvas = document.querySelector(\"canvas#screen\");\ncanvas.width = width;\ncanvas.height = height;\nlet context = canvas.getContext(\"2d\");\n\nlet lineCanvas = document.createElement(\"canvas\");\nlineCanvas.width = width;\nlineCanvas.height = height;\nlet lineContext = lineCanvas.getContext(\"2d\");\n\nlet popCanvas = document.createElement(\"canvas\");\npopCanvas.width = width;\npopCanvas.height = height;\nlet popContext = popCanvas.getContext(\"2d\");\n\nlet animationId;\n\nconst sceneInfo = {\n  x: 0,\n  speed: 4,\n  second: 0,\n  size: 80,\n  popCount: 0,\n  gameCount: 0,\n  popSpeed: 60,\n};\n\nconst nodes = [];\nfor (let i = 0; i < Math.floor(height / sceneInfo.size); i++) {\n  nodes.push(new Array(Math.floor(width / sceneInfo.size)).fill(-1));\n  sceneInfo.gameCount += Math.floor(width / sceneInfo.size);\n}\n\nconst colors = [\"#344f73\", \"#f2b705\", \"#8c591b\", \"#f25c05\"];\n\nfunction pop(size = sceneInfo.size, colorNo = Math.floor(Math.random() * 4)) {\n  let xIdx = Math.floor((Math.random() * width) / size - 1);\n  let yIdx = Math.floor((Math.random() * height) / size - 1);\n  xIdx = xIdx < 0 ? 0 : xIdx;\n  yIdx = yIdx < 0 ? 0 : yIdx;\n\n  if (nodes[yIdx][xIdx] === -1) {\n    sceneInfo.popCount += 1;\n  }\n\n  const x = xIdx * size;\n  const y = yIdx * size;\n\n  nodes[yIdx][xIdx] = colorNo;\n  popContext.fillStyle = colors[colorNo];\n  popContext.fillRect(x, y, size, size);\n}\n\nfunction remove(idx) {\n  const tx = Math.floor(sceneInfo.x / sceneInfo.size);\n  for (let i = 0; i < nodes.length; i++) {\n    if (nodes[i][tx] === idx) {\n      nodes[i][tx] = -1;\n      popContext.clearRect(\n        tx * sceneInfo.size,\n        i * sceneInfo.size,\n        sceneInfo.size,\n        sceneInfo.size\n      );\n      sceneInfo.popCount -= 1;\n      break;\n    }\n  }\n}\n\nconst tick = (timestamp) => {\n  // variable\n  sceneInfo.x = sceneInfo.x + sceneInfo.speed;\n  const s = Math.floor(timestamp / 1000);\n  const f = Math.floor(timestamp / (1000 / 60));\n\n  // 조건부 로직\n  if (sceneInfo.x < 0 || sceneInfo.x > width) {\n    sceneInfo.speed *= -1;\n  }\n  if (sceneInfo.second !== s) {\n    sceneInfo.second = s;\n    if (s % 4 === 0 && sceneInfo.popSpeed > 2) {\n      sceneInfo.popSpeed -= 2;\n    }\n  }\n  if (f % sceneInfo.popSpeed === 0) {\n    pop();\n  }\n\n  // move line\n  lineContext.strokeStyle = \"#080808\";\n  lineContext.lineWidth = \"5\";\n  lineContext.clearRect(0, 0, width, height);\n  lineContext.beginPath();\n  lineContext.moveTo(sceneInfo.x, 0);\n  lineContext.lineTo(sceneInfo.x, height);\n  lineContext.stroke();\n\n  context.clearRect(0, 0, width, height);\n  context.drawImage(popCanvas, 0, 0);\n  context.drawImage(lineCanvas, 0, 0);\n\n  if (sceneInfo.second !== Math.floor(timestamp / 1000)) {\n    sceneInfo.second;\n  }\n\n  if (sceneInfo.gameCount * 0.8 < sceneInfo.popCount) {\n    document.getElementById(\"gameover\").style.display = \"flex\";\n    window.cancelAnimationFrame(animationId);\n  } else {\n    animationId = window.requestAnimationFrame(tick);\n  }\n};\n\nanimationId = window.requestAnimationFrame(tick);\n\nconst buttons = document.querySelectorAll(\".button\");\n[...buttons].forEach((button, idx) => {\n  button.addEventListener(\"click\", () => {\n    remove(idx);\n  });\n});\n"]}